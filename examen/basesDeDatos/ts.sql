/*script para poblar tabla*/
insert into cajeros (cajero,nomApels) values (1,'Cesar Casas'),
(2,'Nayara Rivera'),
(3,'German Huerta'),
(4,'Abraham Yañez'),
(5,'Paloma Ballesteros'),
(6,'Duilio Domingo Prieto'),
(7,'Ester Cantero '),
(8,'Juan Antonio Araujo'),
(9,'Tania Diaz Guerra'),
(10,'Gabriela Guzman');

insert into productos (producto,nombre,precio) values 
(1,'Consome',39),
(2,'Crema de cacahuate',7),
(3,'Crema para café',50),
(4,'Pure de tomate',43),
(5,'Alimento para bebe',32),
(6,'Alimento para mascotas',25),
(7,'Atole',33),
(8,'Avena',42),
(9,'Azúcar',33),
(10,'Café',11),
(11,'Cereales',24),
(12,'Chile piquín',17),
(13,'Especias',17),
(14,'Flan en polvo',6),
(15,'Formulas infantiles',10),
(16,'Gelatinas en polvo/Grenetina',12),
(17,'Harina',40),
(18,'Harina preparada',15),
(19,'Mole',49),
(20,'Sal',24),
(21,'Salsas envasadas',31),
(22,'Sazonadores',8),
(23,'Sopas en sobre',33),
(24,'Cajeta',48),
(25,'Catsup',19),
(26,'Mayonesa',35),
(27,'Mermelada',20),
(28,'Miel',41),
(29,'Te',43),
(30,'Vinagre',44),
(31,'Huevo',38),
(32,'Pastas',26),
(33,'Aceitunas',18),
(34,'Champiñones enteros/rebanados',30),
(35,'Chícharo con zanahoria',28),
(36,'Chícharos enlatados',44),
(37,'Frijoles enlatados',34),
(38,'Frutas en almíbar',43),
(39,'Sardinas',5),
(40,'Atún en agua/aceite',18),
(41,'Chiles enlatados',14),
(42,'Chiles envasados',49),
(43,'Ensaladas enlatadas',27),
(44,'Granos de elote enlatados',34),
(45,'Sopa en lata',21),
(46,'Vegetales en conserva',32),
(47,'Leche condesada',26),
(48,'Leche deslactosada',8),
(49,'Leche en polvo',7),
(50,'Leche evaporada',26),
(51,'Leche light',13),
(52,'Leche pasteurizada',7),
(53,'Leche saborizada',19),
(54,'Leche semidescremada',30),
(55,'Crema',24),
(56,'Yoghurt',35),
(57,'Mantequilla',11),
(58,'Margarina',34),
(59,'Media crema',21),
(60,'Queso',6),
(61,'Papa',44),
(62,'Palomitas',46),
(63,'Frituras de maíz',25),
(64,'Cacahuates',39),
(65,'Botanas saladas',17),
(66,'Barras alimenticias',29),
(67,'Nueces y semillas',33),
(68,'Caramelos',46),
(69,'Dulces enchilados',30),
(70,'Chocolate de mesa',32),
(71,'Chocolate en polvo',32),
(72,'Chocolates',41),
(73,'Gomas de mascar',22),
(74,'Mazapán',7),
(75,'Malvaviscos',18),
(76,'Pulpa de tamarindo',32),
(77,'Pastillas de dulce',31),
(78,'Paletas de dulce',36),
(79,'Tortillas de harina/maíz',7),
(80,'Galletas dulces',15),
(81,'Galletas saladas',29),
(82,'Pastelillos',43),
(83,'Pan de caja',41),
(84,'Pan dulce',16),
(85,'Pan molido',45),
(86,'Pan tostado',11),
(87,'Agua mineral',46),
(88,'Agua natural',40),
(89,'Agua saborizada',41),
(90,'Jarabes',6),
(91,'Jugos/Néctares',18),
(92,'Naranjadas',19),
(93,'Bebidas de soya',23),
(94,'Bebidas en polvo',37),
(95,'Bebidas infantiles',38),
(96,'Bebidas isotónicas',45),
(97,'Energetizantes',49),
(98,'Isotónicos',45),
(99,'Refresco',27),
(100,'Bebidas preparadas',12),
(101,'Cerveza',5),
(102,'Anís',36),
(103,'Brandy',33),
(104,'Ginebra',48),
(105,'Cordiales',21),
(106,'Mezcal',33),
(107,'Jerez',31),
(108,'Ron',4),
(109,'Tequila',49),
(110,'Sidra',34),
(111,'Whiskey',32),
(112,'Vodka',32),
(113,'Toallas húmedas',38),
(114,'Aceite para bebe',8),
(115,'Toallas femeninas',30),
(116,'Algodón',48),
(117,'Tinte para el cabello',18),
(118,'Biberones',24),
(119,'Talco',24),
(120,'Cepillo de dientes',11),
(121,'Shampoo/ Acondicionador',9),
(122,'Cotonetes',26),
(123,'Rastrillos',49),
(124,'Crema corporal/facial',28),
(125,'Papel higiénico',40),
(126,'Crema para afeitar',8),
(127,'Pañuelos faciales',7),
(128,'Dentífricos',8),
(129,'Pañuelos desechables',27),
(130,'Desodorantes en barra/aerosol',18),
(131,'Maquillaje',45),
(132,'Enjuague bucal',30),
(133,'Lubricantes para labios',41),
(134,'Gel/spray',33),
(135,'Loción hidratante',5),
(136,'Jabones corporales/tocados',14),
(137,'Suavizante de telas',37),
(138,'Ácido muriático',10),
(139,'Sosa caustica',18),
(140,'Aluminio',6),
(141,'Pilas',11),
(142,'Shampoo para ropa',16),
(143,'Servilletas',50),
(144,'Servitoallas',18),
(145,'Aromatizantes',24),
(146,'Cera para automóvil',23),
(147,'Cera para calzados',48),
(148,'Pastillas sanitarias',38),
(149,'Limpiadores líquidos',44),
(150,'Limpiadores para pisos',37),
(151,'Jabón de barra',36),
(152,'Cerillos',9),
(153,'Cloro/Blanqueador',43),
(154,'Cloro para ropa',34),
(155,'Jabón en barra',34),
(156,'Insecticidas',48),
(157,'Fibras limpiadoras',27),
(158,'Desinfectantes',47),
(159,'Detergentes para trastes',9),
(160,'Detergente para ropa',18);

insert into maquinas_registradoras (maquina,piso) values (1,1),
(2,1),
(3,1),
(4,2),
(5,2),
(6,2),
(7,3),
(8,3),
(9,3),
(10,1),
(11,4),
(12,4),
(13,4),
(14,5);

insert into venta (cajero,maquina,producto) values (5,5,26),
(8,8,146),
(7,7,6),
(4,4,29),
(8,8,69),
(4,4,109),
(6,6,124),
(5,5,138),
(8,8,41),
(10,10,24),
(5,5,82),
(3,3,1),
(5,5,2),
(5,5,90),
(8,8,36),
(8,8,10),
(7,7,146),
(7,7,135),
(1,1,39),
(10,10,136),
(8,8,25),
(7,7,13),
(9,9,46),
(6,6,7),
(6,6,77),
(5,5,145),
(2,2,160),
(7,7,48),
(8,8,155),
(5,5,108),
(2,2,59),
(3,3,109),
(3,3,29),
(2,2,145),
(3,3,19),
(6,6,80),
(3,3,31),
(5,5,73),
(10,10,133),
(1,1,8),
(10,10,4),
(3,3,137),
(2,2,58),
(10,10,58),
(1,1,147),
(2,2,68),
(2,2,66),
(10,10,82),
(9,9,64),
(7,7,93),
(5,5,65),
(8,8,54),
(5,5,105),
(5,5,5),
(1,1,146),
(8,8,30),
(9,9,85),
(9,9,12),
(2,2,144),
(2,2,100),
(3,3,40),
(8,8,29),
(5,5,39),
(5,5,150),
(6,6,43),
(7,7,141),
(5,5,29),
(5,5,144),
(6,6,103),
(9,9,68),
(4,4,28),
(8,8,18),
(5,5,31),
(3,3,127),
(2,2,62),
(6,6,71),
(6,6,27),
(3,3,38),
(4,4,81),
(7,7,56),
(5,5,65),
(6,6,122),
(9,9,102),
(10,10,64),
(1,1,115),
(6,6,148),
(5,5,85),
(3,3,121),
(4,4,124),
(6,6,28),
(1,1,88),
(2,2,68),
(9,9,62),
(4,4,92),
(9,9,10),
(1,1,78),
(6,6,81),
(4,4,23),
(9,9,153),
(5,5,12),
(3,3,14),
(9,9,57),
(9,9,149),
(7,7,137),
(4,4,133),
(3,3,77),
(2,2,42),
(8,8,116),
(2,2,14),
(10,10,102),
(2,2,9),
(1,1,81),
(1,1,90),
(6,6,24),
(5,5,13),
(6,6,32),
(2,2,142),
(7,7,43),
(1,1,14),
(6,6,111),
(6,6,23),
(1,1,21),
(4,4,112),
(10,10,91),
(5,5,51),
(10,10,55),
(6,6,105),
(2,2,49),
(8,8,61),
(10,10,53),
(9,9,106),
(4,4,43),
(10,10,152),
(1,1,126),
(1,1,124),
(10,10,124),
(10,10,107),
(9,9,132),
(5,5,85),
(9,9,95),
(6,6,108),
(7,7,125),
(7,7,119),
(5,5,38),
(1,1,64),
(1,1,110),
(8,8,156),
(6,6,106),
(2,2,2),
(5,5,86),
(10,10,135),
(9,9,27),
(4,4,158),
(8,8,77),
(7,7,47),
(1,1,28),
(8,8,63),
(5,5,85),
(10,10,51),
(7,7,33),
(10,10,55),
(6,6,133),
(10,10,91),
(7,7,29),
(5,5,84),
(3,3,87),
(1,1,22),
(2,2,67),
(2,2,95),
(4,4,81),
(4,4,34),
(4,4,124),
(8,8,70),
(7,7,66),
(8,8,104),
(4,4,99),
(10,10,117),
(8,8,72),
(8,8,155),
(9,9,6),
(10,10,40),
(3,3,113),
(2,2,8),
(3,3,49),
(8,8,68),
(5,5,106),
(5,5,4),
(3,3,51),
(10,10,60),
(9,9,150),
(2,2,85),
(9,9,110),
(5,5,102),
(9,9,42),
(1,1,85),
(9,9,153),
(9,9,118),
(1,1,89),
(3,3,85),
(3,3,26),
(5,5,32),
(9,9,140),
(9,9,153),
(6,6,41),
(10,10,7),
(9,9,51),
(8,8,19),
(6,6,127),
(10,10,117),
(7,7,113),
(1,1,50),
(6,6,49),
(9,9,152),
(6,6,133),
(3,3,1),
(9,9,49),
(1,1,105),
(3,3,123),
(7,7,76),
(2,2,105),
(9,9,120),
(4,4,70),
(6,6,16),
(7,7,132),
(2,2,133),
(10,10,106),
(8,8,155),
(10,10,138),
(6,6,81),
(3,3,153),
(4,4,34),
(6,6,71),
(9,9,146),
(7,7,14),
(2,2,57),
(2,2,4),
(10,10,10),
(9,9,122),
(5,5,75),
(1,1,159),
(5,5,95),
(7,7,129),
(2,2,139),
(8,8,69),
(2,2,108),
(9,9,118),
(9,9,23),
(5,5,116),
(3,3,16),
(9,9,36),
(2,2,28),
(3,3,85),
(6,6,34),
(10,10,40),
(10,10,119),
(10,10,34),
(9,9,57),
(2,2,123),
(4,4,118),
(10,10,142),
(4,4,1),
(9,9,155),
(5,5,23),
(6,6,128),
(3,3,136),
(6,6,55),
(4,4,145),
(1,1,122),
(7,7,64),
(6,6,95),
(2,2,11),
(7,7,151),
(8,8,50),
(9,9,46),
(1,1,136),
(8,8,160),
(2,2,92),
(3,3,59),
(9,9,30),
(10,10,62),
(6,6,82),
(1,1,158),
(2,2,84),
(4,4,150),
(6,6,46),
(4,4,143),
(9,9,10),
(7,7,86),
(6,6,104),
(4,4,158),
(6,6,124),
(9,9,85),
(5,5,114),
(2,2,151),
(8,8,77),
(7,7,88),
(9,9,85),
(7,7,124),
(7,7,114),
(4,4,143),
(7,7,132),
(8,8,116),
(1,1,12),
(2,2,9),
(4,4,63),
(8,8,139),
(4,4,42),
(10,10,125),
(6,6,152),
(2,2,3),
(2,2,79),
(3,3,48),
(10,10,105),
(2,2,141),
(5,5,70),
(9,9,116),
(2,2,107),
(9,9,49),
(10,10,121),
(9,9,139),
(1,1,58),
(8,8,24),
(7,7,7),
(6,6,139),
(3,3,112),
(9,9,28),
(1,1,33),
(2,2,160),
(7,7,44),
(8,8,71),
(1,1,28),
(5,5,157),
(2,2,56),
(8,8,31),
(9,9,32),
(8,8,91),
(10,10,72),
(9,9,87),
(9,9,2),
(8,8,49),
(6,6,97),
(3,3,138),
(8,8,20),
(7,7,76),
(5,5,141),
(4,4,133),
(7,7,32),
(6,6,153),
(6,6,68),
(6,6,81),
(10,10,8),
(6,6,35),
(2,2,113),
(7,7,120),
(1,1,13),
(5,5,100),
(4,4,23),
(4,4,48),
(6,6,140),
(2,2,130),
(7,7,62),
(8,8,44),
(3,3,152),
(8,8,129),
(5,5,152),
(6,6,147),
(9,9,7),
(6,6,28),
(1,1,145),
(6,6,80),
(9,9,43),
(5,5,76),
(8,8,124),
(6,6,50),
(3,3,71),
(6,6,44),
(3,3,127),
(7,7,89),
(5,5,154),
(9,9,26),
(2,2,118),
(4,4,79),
(4,4,44),
(7,7,83),
(9,9,113),
(2,2,92),
(3,3,124),
(6,6,67),
(6,6,29),
(2,2,82),
(3,3,65),
(10,10,144),
(5,5,135),
(7,7,14),
(4,4,55),
(8,8,34),
(4,4,125),
(5,5,19),
(4,4,83),
(3,3,32),
(9,9,95),
(10,10,14),
(2,2,33),
(2,2,142),
(10,10,72),
(4,4,13),
(7,7,47),
(10,10,65),
(4,4,31),
(9,9,96),
(5,5,88),
(6,6,122),
(4,4,137),
(5,5,77),
(10,10,115),
(2,2,158),
(6,6,142),
(10,10,100),
(1,1,123),
(9,9,25),
(4,4,26),
(3,3,71),
(10,10,9),
(4,4,114),
(10,10,114),
(9,9,156),
(4,4,2),
(3,3,129),
(2,2,68),
(1,1,28),
(8,8,59),
(9,9,92),
(8,8,64),
(2,2,58),
(5,5,148),
(9,9,65),
(4,4,3),
(1,1,58),
(1,1,16),
(6,6,21),
(1,1,91),
(1,1,19),
(5,5,15),
(3,3,54),
(7,7,91),
(5,5,84),
(2,2,127),
(6,6,39),
(5,5,17),
(6,6,39),
(1,1,45),
(4,4,83),
(9,9,106),
(6,6,104),
(6,6,6),
(9,9,69),
(8,8,107),
(1,1,7),
(6,6,160),
(9,9,150),
(8,8,4),
(3,3,17),
(7,7,24),
(9,9,142),
(2,2,147),
(3,3,131),
(1,1,131),
(2,2,89),
(7,7,42),
(4,4,38),
(2,2,37),
(4,4,79),
(8,8,123),
(10,10,28),
(4,4,146),
(4,4,114),
(1,1,148),
(5,5,19),
(8,8,138),
(3,3,42),
(8,8,1),
(5,5,4),
(5,5,42),
(3,3,55),
(3,3,60),
(8,8,43),
(7,7,23),
(4,4,80),
(3,3,8),
(8,8,61),
(7,7,13),
(2,2,91),
(5,5,141),
(4,4,4),
(9,9,27),
(2,2,124),
(5,5,53),
(1,1,54),
(2,2,107),
(8,8,26),
(6,6,21),
(3,3,147),
(2,2,51),
(6,6,94),
(4,4,39),
(4,4,104),
(8,8,13),
(4,4,137),
(2,2,90),
(1,1,83),
(10,10,34),
(10,10,87),
(10,10,63),
(2,2,8),
(5,5,8),
(1,1,124),
(2,2,42),
(7,7,49),
(5,5,45),
(9,9,56),
(6,6,13),
(5,5,39),
(6,6,120),
(6,6,9),
(8,8,108),
(10,10,107),
(5,5,148),
(7,7,9),
(10,10,112),
(4,4,158),
(8,8,56),
(8,8,160),
(10,10,129),
(1,1,94),
(1,1,58),
(6,6,99),
(7,7,133),
(7,7,148),
(8,8,22),
(4,4,122),
(4,4,81),
(3,3,80),
(4,4,18),
(6,6,45),
(5,5,102),
(8,8,156),
(8,8,58),
(5,5,43),
(6,6,150),
(4,4,114),
(3,3,46),
(9,9,119),
(1,1,119),
(2,2,28),
(7,7,76),
(1,1,150),
(7,7,113),
(7,7,46),
(2,2,156),
(3,3,151),
(5,5,24),
(3,3,128),
(8,8,138),
(2,2,52),
(9,9,108),
(1,1,137),
(1,1,138),
(2,2,78),
(7,7,132),
(9,9,35),
(3,3,34),
(6,6,79),
(7,7,82),
(8,8,76),
(9,9,119),
(7,7,42),
(8,8,126),
(1,1,134),
(5,5,155),
(3,3,47),
(4,4,27),
(4,4,43),
(3,3,84),
(2,2,150),
(7,7,83),
(5,5,141),
(4,4,26),
(8,8,149),
(2,2,48),
(9,9,101),
(9,9,37),
(4,4,66),
(1,1,60),
(1,1,45),
(1,1,138),
(9,9,5),
(4,4,60),
(8,8,153),
(10,10,123),
(6,6,104),
(9,9,25),
(7,7,142),
(8,8,94),
(9,9,20),
(5,5,63),
(7,7,122),
(7,7,86),
(8,8,140),
(10,10,39),
(5,5,155),
(9,9,88),
(1,1,45),
(2,2,61),
(10,10,83),
(8,8,41),
(4,4,148),
(6,6,74),
(9,9,58),
(7,7,21),
(6,6,94),
(9,9,45),
(10,10,98),
(10,10,116),
(4,4,29),
(9,9,79),
(4,4,128),
(7,7,50),
(2,2,41),
(2,2,83),
(1,1,140),
(7,7,126),
(7,7,20),
(8,8,107),
(3,3,142),
(2,2,93),
(3,3,116),
(6,6,101),
(10,10,29),
(9,9,121),
(4,4,50),
(8,8,113),
(1,1,109),
(1,1,19),
(3,3,13),
(1,1,15),
(1,1,56),
(1,1,156),
(10,10,37),
(7,7,120),
(7,7,29),
(5,5,16),
(4,4,39),
(7,7,136),
(2,2,141),
(9,9,148),
(4,4,49),
(3,3,137),
(7,7,110),
(2,2,8),
(3,3,15),
(9,9,149),
(8,8,93),
(7,7,75),
(4,4,2),
(1,1,8),
(3,3,141),
(2,2,20),
(2,2,111),
(5,5,110),
(3,3,36),
(8,8,135),
(10,10,44),
(9,9,57),
(2,2,15),
(3,3,114),
(6,6,54),
(2,2,49),
(6,6,36),
(9,9,26),
(2,2,51),
(4,4,40),
(9,9,118),
(8,8,155),
(10,10,108),
(10,10,116),
(3,3,112),
(6,6,9),
(3,3,43),
(6,6,66),
(1,1,15),
(4,4,98),
(2,2,120),
(9,9,147),
(7,7,8),
(6,6,49),
(2,2,102),
(7,7,53),
(5,5,99),
(4,4,27),
(5,5,158),
(7,7,92),
(5,5,16),
(2,2,129),
(10,10,111),
(1,1,63),
(7,7,19),
(2,2,145),
(1,1,138),
(10,10,114),
(5,5,8),
(10,10,35),
(10,10,52),
(6,6,52),
(10,10,66),
(7,7,51),
(2,2,43),
(1,1,124),
(10,10,29),
(5,5,19),
(3,3,110),
(5,5,43),
(7,7,19),
(1,1,112),
(6,6,26),
(5,5,109),
(10,10,131),
(2,2,92),
(9,9,135),
(5,5,64),
(1,1,29),
(9,9,13),
(4,4,70),
(1,1,123),
(3,3,69),
(6,6,134),
(2,2,119),
(3,3,28),
(10,10,112),
(5,5,144),
(1,1,97),
(7,7,79),
(10,10,128),
(3,3,137),
(9,9,87),
(3,3,11),
(2,2,53),
(4,4,18),
(1,1,142),
(6,6,51),
(3,3,74),
(8,8,8),
(4,4,59),
(6,6,82),
(6,6,151),
(1,1,120),
(4,4,112),
(2,2,31),
(7,7,149),
(5,5,135),
(3,3,2),
(3,3,95),
(2,2,36),
(5,5,39),
(3,3,19),
(4,4,29),
(1,1,152),
(6,6,8),
(6,6,125),
(1,1,110),
(3,3,53),
(3,3,141),
(3,3,106),
(9,9,32),
(7,7,3),
(7,7,121),
(8,8,75),
(2,2,20),
(2,2,113),
(5,5,125),
(1,1,6),
(4,4,96),
(4,4,147),
(2,2,42),
(10,10,56),
(5,5,18),
(7,7,81),
(10,10,15),
(4,4,27),
(2,2,61),
(5,11,26),
(8,11,146),
(7,11,6),
(4,11,29),
(8,11,69),
(4,11,109),
(6,12,124),
(5,13,138),
(8,13,41),
(10,12,24),
(5,14,6),
(8,14,146),
(7,14,69),
(4,14,29);

/*2.Mostrar el número de ventas de cada producto, ordenado de más a menos ventas.*/
select productos.nombre,count(productos.nombre) as numero_ventas from venta 
inner join productos  on venta.producto =productos.producto
group by productos.nombre order by numero_ventas desc


/* 3.	Obtener un informe completo de ventas, indicando el nombre del cajero que realizo la venta, 
nombre y precios de los productos vendidos, y el piso en el que se encuentra la máquina registradora donde se realizó la venta.*/
select cajeros.nomapels as nombreCajero,productos.nombre as Prodcuto,
productos.precio,maquinas_registradoras.maquina,maquinas_registradoras.piso from venta 
inner join cajeros on venta.cajero =cajeros.cajero
inner join productos  on venta.producto =productos.producto
inner join maquinas_registradoras on venta.maquina = maquinas_registradoras.maquina

/* 4.	Obtener las ventas totales realizadas en cada piso.*/
select maquinas_registradoras.piso,count(maquinas_registradoras.piso) as numero_ventas_por_piso, sum(productos.precio) as venta_total
from venta 
inner join maquinas_registradoras on venta.maquina = maquinas_registradoras.maquina
inner join productos  on venta.producto =productos.producto
group by maquinas_registradoras.piso order by numero_ventas_por_piso desc

/*5.	Obtener el código y nombre de cada cajero junto con el importe total de sus ventas.*/
select cajeros.cajero as codigo_cajero, cajeros.nomapels as nombreCajero, count(cajeros.cajero) as total_ventas,
sum(productos.precio) as Importe_total_ventas from venta 
inner join cajeros on venta.cajero =cajeros.cajero
inner join productos  on venta.producto =productos.producto
group by cajeros.cajero order by Importe_total_ventas desc

    
/* 6.	Obtener el código y nombre de aquellos cajeros que hayan 
realizado ventas en pisos cuyas ventas totales sean inferiores a los 5000 pesos.*/
select cajeros.cajero, cajeros.nomapels as nombreCajero from venta 
inner join cajeros on venta.cajero =cajeros.cajero
inner join maquinas_registradoras on venta.maquina = maquinas_registradoras.maquina	
where maquinas_registradoras.piso in(	
select maquinas_registradoras.piso
from venta 
inner join maquinas_registradoras on venta.maquina = maquinas_registradoras.maquina
inner join productos  on venta.producto =productos.producto
 group by maquinas_registradoras.piso 
 having sum(productos.precio)< '$5000')
 group by cajeros.cajero
 



